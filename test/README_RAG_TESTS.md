# LangChain RAGåŠŸèƒ½æµ‹è¯•æŒ‡å—

æœ¬ç›®å½•åŒ…å«ç”¨äºæµ‹è¯•å’ŒéªŒè¯LangChain RAGåŠŸèƒ½çš„æµ‹è¯•æ–‡ä»¶ã€‚

## æµ‹è¯•æ–‡ä»¶è¯´æ˜

### 1. `test_rag_simple.py`
**åŸºç¡€RAGåŠŸèƒ½æµ‹è¯•**
- æµ‹è¯•çŸ¥è¯†åº“åˆå§‹åŒ–
- éªŒè¯æ–‡æ¡£åŠ è½½
- æµ‹è¯•åŸºæœ¬æ£€ç´¢åŠŸèƒ½
- æ£€æŸ¥å‘é‡æ•°æ®åº“çŠ¶æ€

**ä½¿ç”¨æ–¹æ³•:**
```bash
python test/test_rag_simple.py
```

### 2. `test_rag_simple_v2.py`
**æ”¹è¿›ç‰ˆRAGåŠŸèƒ½æµ‹è¯•**
- ä¿®å¤æ£€ç´¢å™¨è·å–é—®é¢˜
- å¢åŠ æ€§èƒ½æµ‹è¯•
- æ›´è¯¦ç»†çš„æ£€ç´¢ç»“æœå±•ç¤º
- æ”¯æŒç°æœ‰å‘é‡æ•°æ®åº“

**ä½¿ç”¨æ–¹æ³•:**
```bash
python test/test_rag_simple_v2.py
```

### 3. `test_rag_integration.py` (ä¼˜åŒ–ç‰ˆ)
**RAGé›†æˆæµ‹è¯•**
- å®é™…CAPLä»£ç ç”Ÿæˆæµ‹è¯•
- RAG vs æ— RAGå¯¹æ¯”æµ‹è¯•
- è‡ªå®šä¹‰éœ€æ±‚æµ‹è¯•
- **æ–‡ä»¶è‡ªåŠ¨ä¿å­˜åˆ°å­ç›®å½•**: `test/rag_output/`

**ä½¿ç”¨æ–¹æ³•:**
```bash
python test/test_rag_integration.py
```

## ç›®å½•ç»“æ„ (ä¼˜åŒ–å)

```
test/
â”œâ”€â”€ rag_output/                    # æ‰€æœ‰æµ‹è¯•è¾“å‡ºæ–‡ä»¶
â”‚   â”œâ”€â”€ tests/                     # RAGé›†æˆæµ‹è¯•ç”Ÿæˆçš„æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ rag_test_01_*.capl
â”‚   â”‚   â”œâ”€â”€ rag_test_02_*.capl
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ comparisons/               # å¯¹æ¯”æµ‹è¯•æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ comparison_no_rag_*.capl
â”‚   â”‚   â”œâ”€â”€ comparison_with_rag_*.capl
â”‚   â”‚   â””â”€â”€ comparison_report_*.txt
â”‚   â””â”€â”€ custom/                    # è‡ªå®šä¹‰éœ€æ±‚æµ‹è¯•
â”‚       â””â”€â”€ advanced_custom_test_*.capl
â”œâ”€â”€ test_rag_simple.py            # åŸºç¡€æµ‹è¯•
â”œâ”€â”€ test_rag_integration.py       # é›†æˆæµ‹è¯•
â”œâ”€â”€ README_RAG_TESTS.md          # æœ¬è¯´æ˜æ–‡ä»¶
â””â”€â”€ ...
```

## æµ‹è¯•åŠŸèƒ½ç‰¹æ€§

### çŸ¥è¯†åº“æ”¯æŒ
- **æ”¯æŒçš„æ–‡ä»¶æ ¼å¼**: .txt, .md, .capl, .py
- **é»˜è®¤çŸ¥è¯†åº“ä½ç½®**: `../knowledge_base/`
- **å‘é‡æ•°æ®åº“ä½ç½®**: `../vector_db/`

### æµ‹è¯•åœºæ™¯
1. **åŸºç¡€åŠŸèƒ½æµ‹è¯•**
   - æ–‡æ¡£åŠ è½½å’Œåˆ†å‰²
   - å‘é‡æ•°æ®åº“åˆ›å»º
   - ç›¸ä¼¼æ€§æ£€ç´¢

2. **æ€§èƒ½æµ‹è¯•**
   - åˆå§‹åŒ–è€—æ—¶æµ‹é‡
   - æ£€ç´¢å“åº”æ—¶é—´
   - å†…å­˜ä½¿ç”¨è¯„ä¼°

3. **é›†æˆæµ‹è¯•**
   - å®é™…ä»£ç ç”Ÿæˆ
   - ç»“æœå¯¹æ¯”åˆ†æ
   - æ–‡ä»¶è¾“å‡ºéªŒè¯

## é¢„æœŸè¾“å‡ºç¤ºä¾‹

è¿è¡Œæµ‹è¯•åï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¾“å‡ºï¼š

```
================================================================================
LangChain RAGé›†æˆæµ‹è¯• - ä¼˜åŒ–ç‰ˆ
================================================================================

ğŸš€ å¼€å§‹æµ‹è¯•1: RAGé›†æˆä½¿ç”¨...
ğŸ“ è¾“å‡ºç›®å½•: /path/to/test/rag_output/tests

ğŸš€ å¼€å§‹æµ‹è¯•2: RAGå¯¹æ¯”æµ‹è¯•...
ğŸ“ è¾“å‡ºç›®å½•: /path/to/test/rag_output/comparisons

ğŸš€ å¼€å§‹æµ‹è¯•3: é«˜çº§è‡ªå®šä¹‰éœ€æ±‚...
ğŸ“ è¾“å‡ºç›®å½•: /path/to/test/rag_output/custom

ğŸ“ ç”Ÿæˆçš„ç›®å½•ç»“æ„:
test/
â””â”€â”€ rag_output/
    â”œâ”€â”€ tests/
    â”‚   â”œâ”€â”€ rag_test_01_åˆ›å»ºä¸€ä¸ªé›¨åˆ·å™¨é—´æ­‡æ¨¡å¼æµ‹è¯•ç”¨ä¾‹.capl (2324 bytes)
    â”‚   â”œâ”€â”€ rag_test_02_æµ‹è¯•CANæ¶ˆæ¯å‘¨æœŸå‘é€åŠŸèƒ½.capl (2412 bytes)
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ comparisons/
    â”‚   â”œâ”€â”€ comparison_no_rag_*.capl
    â”‚   â””â”€â”€ ...
    â””â”€â”€ custom/
        â””â”€â”€ advanced_custom_test_*.capl
```

## ä½¿ç”¨æ–¹æ³•

### è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶

```bash
# åŸºç¡€RAGåŠŸèƒ½æµ‹è¯•
python test/test_rag_simple.py

# æ”¹è¿›ç‰ˆRAGåŠŸèƒ½æµ‹è¯•ï¼ˆå«æ€§èƒ½æµ‹è¯•ï¼‰
python test/test_rag_simple_v2.py

# å®Œæ•´RAGé›†æˆæµ‹è¯•ï¼ˆæ–‡ä»¶ä¿å­˜åˆ°test/rag_output/å­ç›®å½•ï¼‰
python test/test_rag_integration.py
```

### è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
python test/test_rag_simple.py && python test/test_rag_simple_v2.py && python test/test_rag_integration.py
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **"æ— æ³•è·å–æ£€ç´¢å™¨"é”™è¯¯**
   - ç¡®ä¿å‘é‡æ•°æ®åº“å·²æ­£ç¡®åˆå§‹åŒ–
   - æ£€æŸ¥çŸ¥è¯†åº“æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   - ä½¿ç”¨ `--rebuild-rag` å‚æ•°é‡å»ºæ•°æ®åº“

2. **çŸ¥è¯†åº“æ–‡ä»¶æ‰¾ä¸åˆ°**
   - ç¡®è®¤ `knowledge_base/` ç›®å½•å­˜åœ¨
   - æ£€æŸ¥æ–‡ä»¶æ‰©å±•åæ˜¯å¦ä¸ºæ”¯æŒçš„æ ¼å¼

3. **å†…å­˜ä¸è¶³**
   - å‡å°‘çŸ¥è¯†åº“æ–‡ä»¶å¤§å°
   - è°ƒæ•´æ–‡æœ¬åˆ†å‰²å‚æ•°

### è°ƒè¯•æŠ€å·§

1. **æŸ¥çœ‹è¯¦ç»†æ—¥å¿—**
```bash
python test/test_rag_simple.py --verbose
```

2. **æ£€æŸ¥å‘é‡æ•°æ®åº“å†…å®¹**
```bash
ls -la vector_db/
```

3. **éªŒè¯çŸ¥è¯†åº“æ–‡ä»¶**
```bash
ls -la knowledge_base/
```

4. **æ£€æŸ¥è¾“å‡ºç›®å½•**
```bash
ls -la test/rag_output/
```

## æ‰©å±•æµ‹è¯•

### æ·»åŠ æ–°çš„æµ‹è¯•ç”¨ä¾‹

åœ¨ `test_rag_integration.py` ä¸­ä¿®æ”¹ `test_requirements` åˆ—è¡¨ï¼š

```python
test_requirements = [
    "ä½ çš„æ–°æµ‹è¯•éœ€æ±‚",
    "å¦ä¸€ä¸ªæµ‹è¯•éœ€æ±‚",
    # æ·»åŠ æ›´å¤š...
]
```

### è‡ªå®šä¹‰çŸ¥è¯†åº“

1. å°†æ–°æ–‡ä»¶æ”¾å…¥ `knowledge_base/` ç›®å½•
2. è¿è¡Œæµ‹è¯•æ—¶ä¼šè‡ªåŠ¨åŠ è½½
3. ä½¿ç”¨ `--rebuild-rag` é‡å»ºå‘é‡æ•°æ®åº“

## ç›¸å…³å‘½ä»¤

### åŸºæœ¬ä½¿ç”¨
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python test/test_rag_integration.py

# ä»…è¿è¡ŒåŸºç¡€æµ‹è¯•
python test/test_rag_simple.py

# ä½¿ç”¨ç‰¹å®šæ¨¡å‹
python test/test_rag_integration.py --model qwen3:14b
```

### æ¸…ç†å’Œé‡å»º
```bash
# åˆ é™¤å‘é‡æ•°æ®åº“ï¼ˆéœ€è¦é‡å»ºï¼‰
rm -rf vector_db/

# æ¸…ç†æµ‹è¯•è¾“å‡º
rm -rf test/rag_output/

# ä½¿ç”¨rebuild-ragå‚æ•°
python capl_generator_langchain.py test.md --enable-rag --rebuild-rag
```